# 01 데이터 모델링의 개념 

### 데이터베이스 생명 주기 
```
요구사항 수집 및 분석 -> 설계 -> 구현 -> 운영 -> 감시 및 개선

데이터 베이스는 '구축-사용-개선-재구축' 의 순환 과정으로 이루어진다.
```
### 데이터 모델링 과정

#### 1. 요구 사항 수집 및 분석
```
실제 문서를 수집하고 분석한다. 문서는 기록으로 남기기위해 만드는 자료이기 때문에 데이터베이스관리의 우선 대상일 가능성이 높다.

담당자와의 인터뷰나 설문조사를 통해 담당자의 의도를 정확하게 파악해야 한다. 개발자가 잘 모르는 분야일 경우 업무에 대해 배운다는
생각으로 인터뷰 하듯 요구 사항을 도출한다.

비슷한 업무를 처리하는 기존의 데이터베이스를 분석한다.

요구사항에서 도출한 내용을 각 업무와 관련된 모든 부분에서 살펴본다. 일반적으로 한 가지 업무가 단독으로 처리되는 경우는 드물고
서로 연관성을 가지고 있기 때문이다.

사용자의 요구 사항은 대부분 모호하며 사용자마다 쓰는 용어도 다르기 때문에 모호성을 제고하고 최대한 구체적이고 명확하게 정리하자.
```
#### 2. 개념적 모델링
```
요구 사항을 수집하고 분석한 결과를 토대로 업무의 핵심적인 개념을 구분하고 전체적인 뼈대를 만든다.

설계자는 사용자의 요구 사항을 분석하여 가장 핵심적인 개체 (entity) 와 개체를 식별할 수 있는 핵심 속성(PK), 그리고 각 개체 간의
관계를 정의하여 데이터베이스화 할 수 있는 일반적인 개념 ER 다이어 그램으로 표현한다.

완성된 ER 다이어 그램으로 담당자의 요구 사항을 제대로 반영했는지 업무 처리 절차에 문제가 없었는지 등을 점검한다.
```
#### 3. 논리적 모델링
```
개념적 모델링에서 추출하지 않았던 상세 속성들을 모두 추출한다. 개념적 모델링 단계에서 핵심적인 속성만 추출했다면 논리적
모델링에서는 실제 필요한 모든 속성을 추출한다.

고객의 이름, 주소, 전화번호 같은 핵심 속성을 앞서 추출했다면 실제 마케팅 업무에 사용할 나이, 성별 등의 상세한 정보가 논리적
모델링에서 추출된다.

ex) 도서(도서번호(PK), 도서이름, 출판사, 도서단가)
    고객(고객번호(PK), 고객이름, 주소, 전화번호)
    주문(주문번호(PK), 고객번호(FK), 도서번호(FK), 주문금액, 주문일자)

  
정규화를 수행한다. (ch 7 에서 설명)
데이터의 표준화를 수행한다. (데이터 용어 사전과 도메인을 정의, 데이터의 형태 및 크기 등을 확정)
```
#### 4. 물리적 모델링
```
논리적 모델을 토대로 DBMS 의 특성에 맞게 저장 구조를 정의한다. (테이블 생성)

- 응답 시간(트랜잭션이 시작되어 종료될 때까지 걸리는 시간) 을 최소화 해야 한다.
- 얼마나 많은 트랜잭션을 동시에 발생시킬 수 있는지 검토해서 생성한다.
- 데이터가 저장될 공간을 효율적으로 배치한다. (저장될 데이터의 특성에 따른 저장 방법 결정 및 인덱스 설계)
```
## ER(Entity Relationship) 모델 

ERD 표기법을 참고하고 실습을 할수 있는 사이트 https://gitmind.com/kr/erd-examples.html , 그 외 필요한 부분은 교재의 그림을 참고한다.

글 설명이 이해가 되지 않는다면 구글링으로 예시에 대한 그림을 찾을 수도 있다. 

### 개체(entity) 와 개체 타입(entity type)
```
개체(entity) 란 사람,사물,장소,개념 사건과 같이 유무형의 정보를 가지고 있는 독립적인 실체(축구의 이해와 같은 책 그 자체) 를 의미한다.
개체(entity) 는 비슷한 속성을 가진 개체 타입(entity type - 도서 같은 대분류를 의미한다.) 을 구성하며, 개체 집합(entity set) 으로 묶인다. 

개체(entity) 는 요구 사항을 통해 도출되며 일반적으로 요구 사항 중 명사인 경우가 많다. 도출된 개체들은 개체 집합으로 묶이고 공통된 속성을
추출하여 의미를 가장 잘 표현할수 있는 개체 타입으로 정의된다.
```
```
* 개체의 특징

유일한 식별자에 의해 식별할 수 있다. 꾸준한 관리가 필요하다. 두 개 이상 영속적으로 존재한다. 업무 프로세스에 이용된다.
반드시 자신의 특징을 나타내는 속성을 포함한다. 다른 개체와 최소 한 개 이상의 관계(relationship) 를 맺고 있다. ?
```
```
* 개체 타입의 유형

개체 타입은 강한 개체 타입(독립적 존재 가능) 과, 약한 개체 타입(상위 개체 타입을 필요) 으로 나뉜다.
예를 들면 데이터베이스에서 직원의 부양 가족은 직원이 존재 해야 존재할 수 있는 약한 개체 타입이다.

강한 개체 타입은 직 사각형으로 표현하며 약한 개체 타입은 두 겹의 직 사각형으로 표현한다. 
```
### 속성 (attribute - 개체의 속성)
```
* 단순 속성과 복합 속성

단순 속성은 더 이상 분해가 불가능하고 복합 속성은 독립적인 의미를 가진 속성으로 분해할수 있다.

예를 들면 주소는 시와 동으로 분해할 수 있다. 복합 속성은 속성의 타원 아래 단순 속성 타원을 추가해서 연결한다. 
```
```
* 단일 값 속성과 다중 값 속성

다중값 속성이란 값을 여러 개 가질 수 있는 속성을 의미한다 예를 들면 취미는 여러 개 가질 수 있다.

단일값 속성은 하나의 타원으로 표현, 다중 값 속성은 두 개의 타원으로 표현한다.
```
```
* 저장 속성과 유도 속성

저장속성으로 부터 유도할 수 있는 속성을 유도 속성이라고 한다.

예를 들면 생년 월일로부터 유도할 수 있는 나이 속성이 있다. 타원형 점선으로 표현한다.
```

참고로 식별자 값은 속성아래 밑줄을 그어 표시하며 약한 개체 식별자는 강한 개체의 속성 값을 가지고 점선으로 표시한다. 325 p

### 관계(relationship) 와 관계 타입(relationship type) 의 유형
```
관계(relationship) 는 개체 사이의 연관성을 나타내는 개념. '고객이 도서를 구입한다' 라고 할 때 '고객' 개체 타입과 '도서' 개체 타입은
'구입한다' 라는 개념으로 연결되는데 이러한 개체 간의 연관성을 관계라고 한다.

관계 타입으로 개체 타입과 개체 타입 간의 연결 가능한 관계를 정의하고, 관계 집합으로 관계의 집합을 나타낼 수 있다.

주문(관계 타입)
1 번 주문, 2 번 주문 ... (각 주문은 관계가 되고 관계 집합으로 묶을 수 있다.) 326 그림 참고 

관계 타입은 마름모꼴로 표현한다.

주문(관계 타입 - relationship type)
1 번 주문(관계 - relationship)
1 번 주문, 2 번 주문(관계 집합 - relationship set)
```
#### 관계 타입의 유형
```
1 진 관계

개체타입 내에서 개체 자신과 관계를 맺는 경우로 학생 개체 타입내에서 각각의 개체 끼리 멘토링 관계를 맺는 경우를 생각하면 된다.
```
```
2 진 관계 

두 개의 개체가 관계를 맺는다. 학생 개체 타입과 학과 개체 타입은 소속이라는 관계를 맺는다.
```
```
3 진 관계 

세 개의 개체가 관계를 맺는다. 자동차 회사 직원은 부품을 조립하여 하나의 자동차를 만드는 프로젝트를 수행하는 관계를 맺고 있다.
```
### 관계 대응수에 대하여

관계 대응 수에 따른 관계 타입의 유형으로 일대일, 일대다, 다대일, 다대다 관계가 있다. 관계 대응수는 ER 다이어 그램의 관계 마름모에 표시할 수 있고 순서대로 읽으면 된다. 

```
관계 대응수의 문제점은 최솟값과 최댓값을 표현할 수 없다는 것이다. ER 다이어그램에서는 최솟값과 최댓값을 관계 실선 위에 표기한다.

예를들어 학과에는 학생이 소속되어 있다는 관계는 학과, 소속, 학생으로 나눌 수 있고 각각 일대 다 다대 일의 관계로 표현한다.
이때 최솟값 최댓값은 각 개체 타입을 기준으로 반대편에 표시해야 한다.

학생은 학과에 0 ~ * 명 등록할 수 있으므로 (0, *) 을 학과쪽 개체 타입에 표시하며, 학과에는 학생이 한명씩 가능하므로
(1, 1) 을 학생쪽 개체 타입에 표시하면 된다. 331 p 그림 참고

관계 대응수를 IE 표기 법(물리적 모델링) 으로 나타낼 때도 개체의 반대편에 표시하며 반대편을 보고 관계를 읽으면 된다.
(IE 표기법 관계 대응수 참고 336 p)
```
### ISA 관계

상위 개체 타입의 특성에 따라 하위 개체 타입이 결정되는 형태를 ISA 관계라고 한다. 상위 개체 타입을 슈퍼 클래스, 하위 개체 타입을 서브 클래스라고 한다. 332 그림 참고

### 참여 제약 조건 

개체 집합 내 모든 개체가 관계에 참여하는지 유무에 따라 전체 참여와 부분 참여로 구분할 수 있다 전체 참여는 두 줄로 관계를 표시하고 부분 참여는 한줄로 표시한다.

```
예를 들면 학생은 강좌를 수강할 때 휴학 등의 이유로 강좌에 개체에 모두 참여할 수 없으므로  한줄로 표시하며
강좌는 폐강 되는 과목 없이 수강 신청을 하는 학생이 반드시 있다고 가정하므로 전체 참여인 두 줄로 표시한다. 333 p
```
### 역할

일반적으로 역할은 관계 다이어 그램으로 관계를 알 수 있다면 생략하지만 관계에서 역할이 명확하지 않으면 반드시 표기한다. 333 p 그림 참고 

### 순환적 관계 
```
순환적 관계란 하나의 개체 타입이 동일한 개체 타입과 순환적으로 관계를 가지는 형태이다.

예를 들면 앞서 설명한 학생 개체가 스스로 멘토링 하는 경우나 사원 개체가 다른 사원 개체에 지원하는 경우를 생각할 수 있다.
각각의 관계는 순환적으로 표현한다 334 p 그림 참고
```
### 약한 개체 타입과 식별자에 대해서

약한 개체 타입은 키 값을 사용하지 않는 대신 관계된 강한 개체 타입의 속성 값을 식별자로 가져서 구분할 수 있다. 식별자를 선정할 때는 식별자로 약한 개체 타입을 특정할 수 있어야 한다.

```
예를 들면 직원이 가족을 부양하는 관계에서 가족은 약한 개체 타입이 되고 가족의 식별자 값으로 어떤 직원의 가족인지 특정할 수 있는
식별자 값을 할당해야 한다.

단순히 직원이름을 식별자로 하면 동명이인이 있을 수 있기 때문에 직원 번호를 같이 할당하는 것이 좋다.

참고로 식별 관계는 두 개의 마름모꼴을 겹쳐서 표시한다.
```
### IE 표기법 (물리적 모델링)
```
강한 개체 타입은 서로 비식별자 관계이므로 점선 관계로 표현한다. (부모 개체의 키가 일반 속성에 포함되는 관계)
약한 개체 타입은 실선 관계로 표현한다.



관계 대응수를 IE 표기 법으로 나타낼 때는 개체의 반대편에 표시하며 반대편을 보고 관계를 읽으면 된다.
(IE 표기법 관계 대응수 참고 336 p)

새발 - 일대 다 관계로 N 쪽에 새발을 표시
O - 선택 참여 최소 참여가 0 일때 표시
| - 필수 참여 최소 참여가 1 일 경우 표시 
```
## 05 모델링 연습

데이터베이스 모델링을 연습하고 ER 다이어 그램까지 작성해보기. ERD 작성 사이트https://gitmind.com/kr/erd-examples.html 

#### 1. 요구 사항 분석 및 수집 결과를 정리
```
* 개체 요구 사항

- 교수(Professor) 는 아이디(ssn), 이름(name), 나이(age), 직위(rank), 연구 분야(speciality) 를 가진다.
- 학과(Department) 에는 학과 번호(dno), 학과 이름(dname), 학과 사무실(office) 이 있다.
- 대학원생(Graduate) 은 아이디(ssn), 이름(name), 나이(age), 학위 과정(deg_prog, 석사/박사) 을 가진다.
- 과제(Project) 는 과제 번호(pid), 지원 기관(sponsor), 개시일(start_date), 종료일(end_date), 예산액(budget) 이 있다.


* 개체 간의 관계에 대한 내용

- 학과마다 그 학과를 운영(run) 하는 교수(학과장이라고 한다) 가 한 명씩 있다.
- 한 교수가 여러 학과에 근무(work-dept) 할 수 있는데, 이 때 각 학과별로 참여 백분율(pct_tie) 이 기록된다.
- 대학원생에게는 학위 과정을 밟을 전공학과(major) 가 하나씩 있다.
- 대학원생에게는 어떤 과목을 들으면 좋을지 조언(advisor) 해주는 선임 대학원생(학생조언자라고 한다.) 이 있다.
- 과제는 한 교수(연구 책임자라고 한다.) 에 의해 관리(manage) 된다.
- 과제는 한 사람 이상의 교수(공동연구책임자라고 한다.) 에 의해 수행(work-in) 된다.
- 한 과제는 한 명 이상의 대학원생(연구조교라고 한다.) 에 의해 수행(work-prog) 된다.
```

#### 2. ER 다이어그램 그리기 (개체)

#### 2-1. 개념적 모델링

#### 3. 논리적 모델링

개념적 모델링이 완료되고 문제가 없다면 논리적 모델링을 위해 관계 데이터 모델로 사상이 이루어진다. ER 다이어 그램을 관계 데이터 모델로 변환하면 아래와 같다.

박스 안에서는 밑 줄을 사용하는 방법을 모르기 때문에 (PK),(FK) 로 표현한다.

```
[개체]
Professor(ssn(PK), name, age, rank, speciality)
Department(dno(PK), dname, office, runprofessorssn(FK))
- 논리적 모델링 과정에서 runprofessorssn(FK) 을 ssn(PK) 를 참조하는 외래키 값으로 추가했다. 앞서 관계 요구사항에서의 학과장을 속성으로 구현

Graduate(ssn(PK), name, age, deg_prog, dno(FK), graduatessn(FK))
- 대학원생은 학과를 가진다. 학과의 PK 값을 참조하는 dno 를 외래키로 추가한다.
- 대학원생은 조언자를 가질 수 있다. 멘토는 다른 대학원생이 되기 때문에 대학원생의 PK 값을 graduatessn 외래키 값으로 받아서 사용한다. (1 진 관계)

Project(pid(PK), sponsor, start_date, end_date, budget, managessn(FK))
- 과제는 교수에 의해 관리되기 때문에 교수의 ssn(PK) 를 참조하는 연구 책임자 속성을 FK 값으로 만들어준다.

[관계]
M:N 관계는 교차 테이블을 생성한다.(관계형 데이터베이스는 정규화된 테이블 2 개로 다대다 관계를 표현할 수 없다.)

work-dept(prfessorssn(FK),dno(FK),pct_time) /*교수의 학과 참여*/
- 교수는 다수의 학과에 소속될 수 있고, 학과 역시 여러 교수가 소속되어 있기 때문에 교수와 학과의 관계는 M:N 의 관계이다.
 (이와 비슷한 다대다 예시로 한 학생이 여러 강좌를 수강할 수 있고, 한 강좌 역시 여러 학생이 들을 수 있는 관계가 있다.)
- 앞서 설명했듯이 테이블은 다대다 관계를 표현할 수 없기 때문에 교차 테이블을 생성한다(work_dept)
- 관계 요구 사항인 학과 백분율은 교차 테이블의 속성으로 포함시킨다.(pct_time)

work-in(professorssn(FK), pid(FK)) /*교수의 과제 수행*/
- 과제는 한 사람 이상의 교수(공동연구책임자라고 한다.) 에 의해 수행(work-in) 된기 때문에 다대다 관계로 만든다. 다른 요구 사항이
없기 때문에 중간 테이블만 구현한다.

work-prog(graduatessn(FK), pid(FK)) /*대학원생의 과제 수행*/
- 한 과제는 한 명 이상의 대학원생(연구조교라고 한다.) 에 의해 수행(work-prog) 된다. 마찬가지로 다른 요구 사항이 없기 때문에
중간 테이블만 구현한다.
```

#### 4. 물리적 모델링
